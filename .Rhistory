round(sum(data) / nrow(data), 4)})), plot_points[, 1:ncol(.)]) %>%
`rownames<-`(c(.$pitch_type[1:(nrow(.) - 3)], "Outcomes", "Color",
"Shape")) %>%
select(-pitch_type, -row_id)
if (ncol(cluster_names) >= 4) {
cluster_table <- rbind(cluster_names,
c(pitcher_id, year, "pitch", "clusters",
rep("", ncol(cluster_names) - 4))) %>%
`rownames<-`(c(rownames(cluster_names), "Pitcher")) %>%
suppressWarnings()
View(cluster_table)
} else {
View(cluster_names)
}
}
set.seed(333)
get_pitcher_clusters <- function(pitcher_mlbid, season) {
print(plot_clusters(pitcher_id = pitcher_mlbid, year = season))
get_cluster_table(pitcher_id = pitcher_mlbid, year = season)
}
set.seed(333)
get_pitcher_clusters(pitcher_mlbid = 572020, season = 2016)
set.seed(333)
get_cluster_table <- function(pitcher_id, year) {
cluster_names <- cluster_df %>%
filter(pitcher == pitcher_id, game_year == year) %>%
select(pitch_type) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitch_type", "cluster")) %>%
group_by(pitch_type, cluster) %>%
summarise(count = n(), .groups = "drop") %>%
pivot_wider(names_from = cluster, values_from = count,
values_fill = 0) %>%
select(pitch_type, sort(colnames(.)[2:ncol(.)])) %>%
mutate(row_id = row_number()) %>%
arrange(match(row_id, apply(across(-pitch_type), 2, which.max))) %>%
as.data.frame() %>%
select(pitch_type, row_id, colnames(select(., -pitch_type,
-row_id))) %>%
rbind(., c("", "", sapply(1:(ncol(.) - 2), function(x) {
data <- cluster_df %>%
select(pitcher, game_year, outcome) %>%
filter(pitcher == pitcher_id, game_year == year) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "class")) %>%
filter(class == x) %>%
select(outcome)
round(sum(data) / nrow(data), 4)})), plot_points[, 1:ncol(.)]) %>%
`rownames<-`(c(.$pitch_type[1:(nrow(.) - 3)], "Outcomes", "Color",
"Shape")) %>%
select(-pitch_type, -row_id)
if (ncol(cluster_names) >= 4) {
cluster_table <- rbind(cluster_names,
c(pitcher_id, year, "pitch", "clusters",
rep("", ncol(cluster_names) - 4))) %>%
`rownames<-`(c(rownames(cluster_names), "Pitcher")) %>%
suppressWarnings()
View(cluster_table)
} else {
View(cluster_names)
}
}
set.seed(333)
get_pitcher_clusters <- function(pitcher_mlbid, season) {
print(plot_clusters(pitcher_id = pitcher_mlbid, year = season))
get_cluster_table(pitcher_id = pitcher_mlbid, year = season)
}
set.seed(333)
get_pitcher_clusters(pitcher_mlbid = 572020, season = 2021)
get_pitcher_clusters(pitcher_mlbid = 346798, season = 2015)
get_pitcher_clusters(pitcher_mlbid = 624133, season = 2022)
get_pitcher_clusters(pitcher_mlbid = 628317, season = 2020)
get_pitcher_clusters(pitcher_mlbid = 641540, season = 2021)
get_pitcher_clusters(pitcher_mlbid = 641540, season = 20210)
source("C:/Users/lukev/pitch-clustering/Dickey.R", echo=TRUE)
get_dickey_clusters(201522)
source("C:/Users/lukev/pitch-clustering/Project.R", echo=TRUE)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events, type) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(event = as.numeric(
events %in% c("strikeout", "field_out", "grounded_into_double_play",
"double_play", "triple_play", "pickoff_1b", "pickoff_3b",
"caught_stealing_2b", "caught_stealing_home", "other_out",
"strikeout_double_play")), call = as.numeric(type == "S"),
score = event + call, outcome = as.numeric(score >= 1)) %>%
ungroup()
View(outcomes_df)
unique(outcomes_df$events)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events, type) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(event = as.numeric(
events %in% c("strikeout", "field_out", "grounded_into_double_play",
"double_play", "triple_play", "pickoff_1b", "pickoff_3b",
"caught_stealing_2b", "caught_stealing_home", "other_out",
"strikeout_double_play")), call = as.numeric(type == "S"),
score = event + call, outcome = as.numeric(score >= 1),
strike_percentage = as.numeric(type != "B"), ba = as.numeric(
events %in% c("single", "double", "triple", "home_run")),
hr_percentage = as.numeric(events == "home_run")) %>%
ungroup()
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events, type) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(event = as.numeric(
events %in% c("strikeout", "field_out", "grounded_into_double_play",
"double_play", "triple_play", "pickoff_1b", "pickoff_3b",
"caught_stealing_2b", "caught_stealing_home", "other_out",
"strikeout_double_play")), call = as.numeric(type == "S"),
score = event + call, outcome = as.numeric(score >= 1),
strike_percentage = as.numeric(type != "B"), ba = as.numeric(
events %in% c("single", "double", "triple", "home_run")),
hr_percentage = as.numeric(events == "home_run")) %>%
ungroup()
View(outcomes_df)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events, type) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(event = as.numeric(
events %in% c("strikeout", "field_out", "grounded_into_double_play",
"double_play", "triple_play", "pickoff_1b", "pickoff_3b",
"caught_stealing_2b", "caught_stealing_home", "other_out",
"strikeout_double_play")), call = as.numeric(type == "S"),
score = event + call, outcome = as.numeric(score >= 1),
strike_percentage = as.numeric(type != "B"), pitch_ba = as.numeric(
events %in% c("single", "double", "triple", "home_run")),
hr_percentage = as.numeric(events == "home_run")) %>%
ungroup() %>%
select(outcome, pitch_ba, strike_percentage, hr_percentage)
cluster_df <- cbind(pitcher_df, outcomes_df, clusters, model_info) %>%
select(-game_pk, -game_date, -at_bat_number, -pitch_number, -events, -type,
-pitcher_year) %>%
`colnames<-`(c(colnames(.)[1:8], "cluster", "mod"))
View(pitcher_df)
View(cluster_df)
cluster_df <- cbind(pitcher_df, outcomes_df, clusters, model_info) %>%
select(-game_pk, -game_date, -at_bat_number, -pitch_number, -events, -type,
-pitcher_year) %>%
`colnames<-`(c(colnames(.)[1:11], "cluster", "mod"))
View(cluster_df)
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == pitcher_id, game_year == year) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "class")) %>%
filter(class == x) %>%
select(outcome, pitch_ba, strike_percentage, hr_percentage) %>% View()
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "class")) %>%
filter(class == x) %>%
select(outcome, pitch_ba, strike_percentage, hr_percentage) %>% View()
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == x) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>% View()
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1\) %>%
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>% View()
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>% t() %>% View()
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
mutate(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.))
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.))
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.)) %>%
View()
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t() %>% View*
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t() %>% View()
sapply(1:9, function(x) {
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t()}
sapply(1:9, function(x) {
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t()})
sapply(1:9, function(x) {
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == x) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t()})
set.seed(333)
get_cluster_table <- function(pitcher_id, year) {
cluster_names <- cluster_df %>%
filter(pitcher == pitcher_id, game_year == year) %>%
select(pitch_type) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitch_type", "cluster")) %>%
group_by(pitch_type, cluster) %>%
summarise(count = n(), .groups = "drop") %>%
pivot_wider(names_from = cluster, values_from = count,
values_fill = 0) %>%
select(pitch_type, sort(colnames(.)[2:ncol(.)])) %>%
mutate(row_id = row_number()) %>%
arrange(match(row_id, apply(across(-pitch_type), 2, which.max))) %>%
as.data.frame() %>%
select(pitch_type, row_id, colnames(select(., -pitch_type,
-row_id))) %>%
rbind(., c("", "", sapply(1:(ncol(.) - 2), function(x) {
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba",
"k_percentage", "hr_percentage", "class")) %>%
filter(class == x) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.),
pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.),
hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t()})), plot_points[, 1:ncol(.)]) %>%
`rownames<-`(c(.$pitch_type[1:(nrow(.) - 3)], "Outcomes", "Pitch BA",
"K%", "HR%", "Color", "Shape")) %>%
select(-pitch_type, -row_id)
if (ncol(cluster_names) >= 4) {
cluster_table <- rbind(cluster_names,
c(pitcher_id, year, "pitch", "clusters",
rep("", ncol(cluster_names) - 4))) %>%
`rownames<-`(c(rownames(cluster_names), "Pitcher")) %>%
suppressWarnings()
View(cluster_table)
} else {
View(cluster_names)
}
}
set.seed(333)
get_pitcher_clusters <- function(pitcher_mlbid, season) {
print(plot_clusters(pitcher_id = pitcher_mlbid, year = season))
get_cluster_table(pitcher_id = pitcher_mlbid, year = season)
}
set.seed(333)
get_pitcher_clusters(pitcher_mlbid = 621111, season = 2021)
set.seed(333)
get_cluster_table <- function(pitcher_id, year) {
cluster_names <- cluster_df %>%
filter(pitcher == pitcher_id, game_year == year) %>%
select(pitch_type) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitch_type", "cluster")) %>%
group_by(pitch_type, cluster) %>%
summarise(count = n(), .groups = "drop") %>%
pivot_wider(names_from = cluster, values_from = count,
values_fill = 0) %>%
select(pitch_type, sort(colnames(.)[2:ncol(.)])) %>%
mutate(row_id = row_number()) %>%
arrange(match(row_id, apply(across(-pitch_type), 2, which.max))) %>%
as.data.frame() %>%
select(pitch_type, row_id, colnames(select(., -pitch_type,
-row_id))) %>%
rbind(., c("", "", sapply(1:(ncol(.) - 2), function(x) {
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage,
hr_percentage) %>%
filter(pitcher == pitcher_id, game_year == year) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba",
"k_percentage", "hr_percentage", "class")) %>%
filter(class == x) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.),
pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.),
hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t()})), plot_points[, 1:ncol(.)]) %>%
`rownames<-`(c(.$pitch_type[1:(nrow(.) - 3)], "Outcomes", "Pitch BA",
"K%", "HR%", "Color", "Shape")) %>%
select(-pitch_type, -row_id)
if (ncol(cluster_names) >= 4) {
cluster_table <- rbind(cluster_names,
c(pitcher_id, year, "pitch", "clusters",
rep("", ncol(cluster_names) - 4))) %>%
`rownames<-`(c(rownames(cluster_names), "Pitcher")) %>%
suppressWarnings()
View(cluster_table)
} else {
View(cluster_names)
}
}
set.seed(333)
get_pitcher_clusters <- function(pitcher_mlbid, season) {
print(plot_clusters(pitcher_id = pitcher_mlbid, year = season))
get_cluster_table(pitcher_id = pitcher_mlbid, year = season)
}
set.seed(333)
get_pitcher_clusters(pitcher_mlbid = 621111, season = 2021)
get_cluster_table <- function(pitcher_id, year) {
cluster_names <- cluster_df %>%
filter(pitcher == pitcher_id, game_year == year) %>%
select(pitch_type) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitch_type", "cluster")) %>%
group_by(pitch_type, cluster) %>%
summarise(count = n(), .groups = "drop") %>%
pivot_wider(names_from = cluster, values_from = count,
values_fill = 0) %>%
select(pitch_type, sort(colnames(.)[2:ncol(.)])) %>%
mutate(row_id = row_number()) %>%
arrange(match(row_id, apply(across(-pitch_type), 2, which.max))) %>%
as.data.frame() %>%
select(pitch_type, row_id, colnames(select(., -pitch_type,
-row_id))) %>%
rbind(., c("", "", sapply(1:(ncol(.) - 2), function(x) {
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage,
hr_percentage) %>%
filter(pitcher == pitcher_id, game_year == year) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba",
"k_percentage", "hr_percentage", "class")) %>%
filter(class == x) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.),
pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.),
hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t()})), plot_points[, 1:ncol(.)]) %>%
# `rownames<-`(c(.$pitch_type[1:(nrow(.) - 3)], "Outcomes", "Pitch BA",
#                "K%", "HR%", "Color", "Shape")) %>%
select(-pitch_type, -row_id)
if (ncol(cluster_names) >= 4) {
cluster_table <- rbind(cluster_names,
c(pitcher_id, year, "pitch", "clusters",
rep("", ncol(cluster_names) - 4))) %>%
`rownames<-`(c(rownames(cluster_names), "Pitcher")) %>%
suppressWarnings()
View(cluster_table)
} else {
View(cluster_names)
}
}
Q
get_cluster_table <- function(pitcher_id, year) {
cluster_names <- cluster_df %>%
filter(pitcher == pitcher_id, game_year == year) %>%
select(pitch_type) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitch_type", "cluster")) %>%
group_by(pitch_type, cluster) %>%
summarise(count = n(), .groups = "drop") %>%
pivot_wider(names_from = cluster, values_from = count,
values_fill = 0) %>%
select(pitch_type, sort(colnames(.)[2:ncol(.)])) %>%
mutate(row_id = row_number()) %>%
arrange(match(row_id, apply(across(-pitch_type), 2, which.max))) %>%
as.data.frame() %>%
select(pitch_type, row_id, colnames(select(., -pitch_type,
-row_id))) %>%
rbind(., c("", "", sapply(1:(ncol(.) - 2), function(x) {
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage,
hr_percentage) %>%
filter(pitcher == pitcher_id, game_year == year) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba",
"k_percentage", "hr_percentage", "class")) %>%
filter(class == x) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.),
pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.),
hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t()})), plot_points[, 1:ncol(.)]) %>%
# `rownames<-`(c(.$pitch_type[1:(nrow(.) - 3)], "Outcomes", "Pitch BA",
#                "K%", "HR%", "Color", "Shape")) %>%
select(-pitch_type, -row_id)
if (ncol(cluster_names) >= 4) {
cluster_table <- rbind(cluster_names,
c(pitcher_id, year, "pitch", "clusters",
rep("", ncol(cluster_names) - 4))) %>%
`rownames<-`(c(rownames(cluster_names), "Pitcher")) %>%
suppressWarnings()
View(cluster_table)
} else {
View(cluster_names)
}
}
set.seed(333)
get_pitcher_clusters <- function(pitcher_mlbid, season) {
print(plot_clusters(pitcher_id = pitcher_mlbid, year = season))
get_cluster_table(pitcher_id = pitcher_mlbid, year = season)
}
set.seed(333)
get_pitcher_clusters(pitcher_mlbid = 621111, season = 2021)
sapply(1:9, function(x) {
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t()})
sapply(1:9, function(x) {
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == 1) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t()})
a
1 + 2
sapply(1:9, function(x) {
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == x) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t()})
sapply(1:9, function(x) {
cluster_df %>%
select(pitcher, game_year, outcome, pitch_ba, strike_percentage, hr_percentage) %>%
filter(pitcher == 624133, game_year == 2022) %>%
cbind(., model$classification) %>%
`colnames<-`(c("pitcher", "game_year", "outcome", "pitch_ba", "k_percentage", "hr_percentage", "class")) %>%
filter(class == x) %>%
select(outcome, pitch_ba, k_percentage, hr_percentage) %>%
summarize(outcome = sum(outcome) / nrow(.), pitch_ba = sum(pitch_ba) / nrow(.),
k_percentage = sum(k_percentage) / nrow(.), hr_percentage = sum(hr_percentage) / nrow(.)) %>%
t()})
