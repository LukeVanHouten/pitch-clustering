View(more_stats_info)
rm(g_ari_info)
write.csv(more_stats_info, "model_info.csv", row.names = FALSE)
test_df_2 <- read.csv("model_info.csv")
View(test_df_2)
more_stats_info <- more_stats_df %>%
group_by(pitcher, game_year) %>%
mutate(model = replace(model, 1, "model")) %>%
ungroup() %>%
select(model) %>%
mutate(model, as.character)
more_stats_info <- more_stats_df %>%
group_by(pitcher, game_year) %>%
mutate(model = replace(model, 1, "model")) %>%
ungroup() %>%
select(model) %>%
mutate(model, as.character(model))
View(more_stats_info)
more_stats_info <- more_stats_df %>%
group_by(pitcher, game_year) %>%
mutate(model = replace(model, 1, "model")) %>%
ungroup() %>%
mutate(model = as.character(model))
View(more_stats_info)
write.csv(more_stats_info$model, "model_info.csv", row.names = FALSE)
test_df_2 <- read.csv("model_info.csv")
View(more_stats_info)
View(more_stats_info)
View(more_stats_df)
more_stats_info <- more_stats_df %>%
group_by(pitcher, game_year) %>%
mutate(model = replace(model, 1, "model")) %>%
ungroup() %>%
select(model) %>%
sapply(as.character)
write.csv(more_stats_info, "model_info.csv", row.names = FALSE)
more_stats_info <- more_stats_df %>%
group_by(pitcher, game_year) %>%
mutate(model = replace(model, 1, "model")) %>%
ungroup() %>%
select(model) %>%
mutate(model = as.character(model))
write.csv(more_stats_info, "model_info.csv", row.names = FALSE)
View(more_stats_info)
View(more_stats_df)
get_pitcher_clusters <- function(pitcher_mlbid, season) {
print(plot_clusters(pitcher_id = pitcher_mlbid, year = season))
get_cluster_table(pitcher_id = pitcher_mlbid, year = season)
model_info <- more_stats_df %>%
filter(pitcher == pitcher_mlbid, game_year == season) %>%
select(model) %>%
head(5)
assign("chosen_model", model_info, envir = globalenv())
View(chosen_model)
}
get_pitcher_clusters(pitcher_mlbid = 669923, season = 2023)
View(chosen_model[[1]][[1]])
View(model_info)
rm(model_info)
get_pitcher_clusters <- function(pitcher_mlbid, season) {
print(plot_clusters(pitcher_id = pitcher_mlbid, year = season))
get_cluster_table(pitcher_id = pitcher_mlbid, year = season)
model_info <- more_stats_df %>%
filter(pitcher == pitcher_mlbid, game_year == season) %>%
select(model) %>%
head(5)
assign("chosen_model", model_info, envir = globalenv())
View(chosen_model)
}
get_pitcher_clusters(pitcher_mlbid = 669923, season = 2023)
View(chosen_model[[1]][[1]])
more_stats_df <- cluster_df %>%
group_by(pitcher, game_year) %>%
mutate(model = replace(model, 4, paste("BIC =", round(model[[1]]$bic, 4))),
model = replace(model, 5, paste("ICL =", round(model[[1]]$icl,4))),
model = replace(model, 6, model[[1]]$modelName)) %>%
ungroup() %>%
select(pitcher, game_year, model)
View(more_stats_df)
more_stats_info <- more_stats_df %>%
group_by(pitcher, game_year) %>%
mutate(model = replace(model, 1, "model")) %>%
ungroup() %>%
select(model) %>%
mutate(model = as.character(model))
write.csv(more_stats_info, "model_info.csv", row.names = FALSE)
test_df_2 <- read.csv("model_info.csv")
View(test_df_2)
get_pitcher_clusters(pitcher_mlbid = 669923, season = 2023)
get_pitcher_clusters <- function(pitcher_mlbid, season) {
print(plot_clusters(pitcher_id = pitcher_mlbid, year = season))
get_cluster_table(pitcher_id = pitcher_mlbid, year = season)
model_info <- more_stats_df %>%
filter(pitcher == pitcher_mlbid, game_year == season) %>%
select(model) %>%
head(6)
assign("chosen_model", model_info, envir = globalenv())
View(chosen_model)
}
get_pitcher_clusters(pitcher_mlbid = 669923, season = 2023)
View(chosen_model[[1]][[1]])
View(chosen_model[[1]][[1]])
View(chosen_model[[1]][[4]])
View(test_df_2)
View(chosen_model[[1]][[1]])
more_stats_df <- cluster_df %>%
group_by(pitcher, game_year) %>%
mutate(model = replace(model, 4, paste("BIC =", round(model[[1]]$bic, 4))),
model = replace(model, 5, paste("ICL =", round(model[[1]]$icl, 4))),
model = replace(model, 6, paste("Model name =",
model[[1]]$modelName)),
model = replace(model, 7, paste("n =", round(model[[1]]$n, 4))),
model = replace(model, 8, paste("df =", round(model[[1]]$df,4)))) %>%
ungroup() %>%
select(pitcher, game_year, model)
View(more_stats_info)
View(more_stats_df)
View(more_stats_df[[3]][[1]])
more_stats_df <- cluster_df %>%
group_by(pitcher, game_year) %>%
mutate(model = replace(model, 4, paste("BIC =", round(model[[1]]$bic, 4))),
model = replace(model, 5, paste("ICL =", round(model[[1]]$icl, 4))),
model = replace(model, 6, paste("Model name =",
model[[1]]$modelName)),
model = replace(model, 7, paste("n =", round(model[[1]]$n, 4))),
model = replace(model, 8, paste("df =", round(model[[1]]$df, 4))),
model = replace(model, 9, paste("Log-likelihood =",
round(model[[1]]$loglik, 4)))) %>%
ungroup() %>%
select(pitcher, game_year, model)
View(more_stats_info)
View(more_stats_df)
more_stats_df <- cluster_df %>%
group_by(pitcher, game_year) %>%
mutate(model = replace(model, 4, paste("BIC =", round(model[[1]]$bic, 4))),
model = replace(model, 5, paste("ICL =", round(model[[1]]$icl, 4))),
model = replace(model, 6, paste("Model name =",
model[[1]]$modelName)),
model = replace(model, 7, paste("n =", model[[1]]$n)),
model = replace(model, 8, paste("df =", model[[1]]$df)),
model = replace(model, 9, paste("Log-likelihood =",
round(model[[1]]$loglik, 4)))) %>%
ungroup() %>%
select(pitcher, game_year, model)
more_stats_info <- more_stats_df %>%
group_by(pitcher, game_year) %>%
mutate(model = replace(model, 1, "model")) %>%
ungroup() %>%
select(model) %>%
mutate(model = as.character(model))
View(more_stats_info)
write.csv(more_stats_info, "model_info.csv", row.names = FALSE)
test_df_2 <- read.csv("model_info.csv")
get_pitcher_clusters <- function(pitcher_mlbid, season) {
print(plot_clusters(pitcher_id = pitcher_mlbid, year = season))
get_cluster_table(pitcher_id = pitcher_mlbid, year = season)
model_info <- more_stats_df %>%
filter(pitcher == pitcher_mlbid, game_year == season) %>%
select(model) %>%
head(6)
assign("chosen_model", model_info, envir = globalenv())
View(chosen_model)
}
get_pitcher_clusters(pitcher_mlbid = 669923, season = 2023)
get_pitcher_clusters <- function(pitcher_mlbid, season) {
print(plot_clusters(pitcher_id = pitcher_mlbid, year = season))
get_cluster_table(pitcher_id = pitcher_mlbid, year = season)
model_info <- more_stats_df %>%
filter(pitcher == pitcher_mlbid, game_year == season) %>%
select(model) %>%
head(9)
assign("chosen_model", model_info, envir = globalenv())
View(chosen_model)
}
get_pitcher_clusters(pitcher_mlbid = 669923, season = 2023)
View(chosen_model[[1]][[1]])
stats_df %>%
filter(game_year >= 2021, pitch_type == "KN") %>%
View()
which(is.na((stats_df %>%
filter(game_year >= 2021, pitch_type == "KN"))))
which(is.na((stats_df %>%
filter(game_year >= 2021, pitch_type == "KN"))$release_spin_rate))
mean((stats_df %>%
filter(game_year >= 2021, pitch_type == "KN"))$release_spin_rate))
mean((stats_df %>%
filter(game_year >= 2021, pitch_type == "KN"))$release_spin_rate)
mean((stats_df %>%
filter(game_year >= 2021, pitch_type == "KN", release_spin_rate < 500))$release_spin_rate)
abs(round(rnorm(2775), mean = mean((stats_df %>%
filter(game_year >= 2021, pitch_type == "KN", release_spin_rate < 500))$release_spin_rate),  sd = 50), 0))
abs(round(rnorm(2775), mean = mean((stats_df %>%
filter(game_year >= 2021, pitch_type == "KN", release_spin_rate < 500))$release_spin_rate),  sd = 50), 0)
abs(round(rnorm(2775), mean = mean((stats_df %>%
filter(game_year >= 2021, pitch_type == "KN", release_spin_rate < 500))$release_spin_rate)), sd = 50), 0))
abs(round(rnorm(2775), mean = mean((stats_df %>%
filter(game_year >= 2021, pitch_type == "KN", release_spin_rate < 500))$release_spin_rate), sd = 50), 0))
abs(round(rnorm(2775), mean = 266, sd = 50), 0))
abs(round(rnorm(2775, mean = 266, sd = 50), 0))
abs(round(rnorm(2775, mean = 266, sd = 100), 0))
max(abs(round(rnorm(2775, mean = 266, sd = 100), 0)))
set.seed(333)
max(abs(round(rnorm(round(1.1 * 2775), mean = 266, sd = 100), 0)))
max(abs(round(rnorm(round(1.5 * 2775), mean = 266, sd = 100), 0)))
length(which(abs(round(rnorm(round(1.5 * 2775), mean = 266, sd = 100), 0))) < 500))
length(which(abs(round(rnorm(round(1.5 * 2775), mean = 266, sd = 100), 0)) < 500))
length(which(abs(round(rnorm(round(1.1 * 2775), mean = 266, sd = 100), 0)) < 500))
length(which(abs(round(rnorm(round(1 * 2775), mean = 266, sd = 100), 0)) < 500))
length(which(abs(round(rnorm(round(1.05 * 2775), mean = 266, sd = 100), 0)) < 500))
plot(abs(round(rnorm(round(1.05 * 2775), mean = 266, sd = 100), 0)) < 500)
plot(abs(round(rnorm(round(1.05 * 2775), mean = 266, sd = 100), 0)))
plot(abs(round(rnorm(round(1.05 * 2775), mean = 266, sd = 133), 0)))
sample <- abs(round(rnorm(round(1.05 * 2775), mean = 266, sd = 133), 0))
rm(g_ari_df)
sample[((min(na.omit(stats_df$release_spin_rate))) < sample) & (spin_rates_sample < 500)][1:2775]
sample[((min(na.omit(stats_df$release_spin_rate))) < sample) & (sample < 500)][1:2775]
plot(sample[((min(na.omit(stats_df$release_spin_rate))) < sample) & (sample < 500)][1:2775])
round(mean(filter(stats_df, game_year >= 2021,
pitch_type == "KN", release_spin_rate <
500)$release_spin_rate), 0)
rm(sample)
get_pitcher_clusters(pitcher_mlbid = 669923, season = 2023)
View(Mclust::plot)
View(mclust::plot)
View(plot)
View(chosen_model[[1]][[1]])
View(chosen_model[[1]][[1]]$z)
options(scipen = 10)
View(chosen_model[[1]][[1]]$z)
View(chosen_model[[1]][[1]]$z$V7)
View(chosen_model[[1]][[1]]$z[7, ])
View(chosen_model[[1]][[1]]$z[, 7])
View(as.data.frame(chosen_model[[1]][[1]]$z[, 7]))
View(as.data.frame(chosen_model[[1]][[1]]$z[, 7])) %>% `colnames<-`(c("z"))
View(pitcher_df)
get_model <- function(pitcher_id, year) {
features_df <- pitcher_df %>%
select(pitcher, game_year, release_speed, release_spin_rate, pfx_x,
pfx_z) %>%
filter(pitcher == pitcher_id, game_year == year) %>%
select(-pitcher, -game_year)
model <- Mclust(features_df, modelNames = "VVV")
assign("gotten_model", model, envir = globalenv())
}
get_model(pitcher_id = 669302, year = 2023)
View(gotten_model)
rm(gotten_model)
get_model <- function(pitcher_id, year) {
features_df <- pitcher_df %>%
select(pitcher, game_year, release_speed, release_spin_rate, pfx_x,
pfx_z) %>%
filter(pitcher == pitcher_id, game_year == year) %>%
select(-pitcher, -game_year)
local_model <- Mclust(features_df, modelNames = "VVV")
assign("model", local_model, envir = globalenv())
}
get_model(pitcher_id = 669302, year = 2023)
View(model)
plot(model, what == "BIC")
plot(model, what = "BIC")
View(model)
get_pitcher_clusters(pitcher_mlbid = 669302, season = 2023)
get_pitcher_clusters(pitcher_mlbid = 669302, season = 2021)
get_pitcher_clusters(pitcher_mlbid = 669302, season = 2023)
get_pitcher_clusters(pitcher_mlbid = 669302, season = 2023)
get_pitcher_clusters(pitcher_mlbid = 669923, season = 2023)
get_pitcher_clusters(pitcher_mlbid = 669302, season = 2021)
get_pitcher_clusters(pitcher_mlbid = 669302, season = 2023)
get_pitcher_clusters(pitcher_mlbid = 605483, season = 2023)
View(chosen_model[[1]][[1]])
View(model)
plot(model)
get_pitcher_clusters(pitcher_mlbid = 669302, season = 2023)
get_pitcher_clusters(pitcher_mlbid = 669302, season = 2021)
get_pitcher_clusters(pitcher_mlbid = 669302, season = 2022)
get_pitcher_clusters(pitcher_mlbid = 669302, season = 2023)
colnames(stats_df)
pitcher_df <- stats_df %>%
select(pitch_type, game_pk, game_year, game_date, pitcher, release_speed,
release_spin_rate, pfx_x, pfx_z, at_bat_number, pitch_number,
events) %>%
mutate(pitcher_year = paste0(pitcher, "_", game_year)) %>%
filter(pitcher_year %in% pitcher_names$pitcher_year,
!is.na(release_speed), !is.na(release_spin_rate), !is.na(pfx_x),
!is.na(pfx_z), !(pitch_type %in% c("IN", "PO", ""))) %>%
arrange(pitcher, game_date, game_pk, at_bat_number, pitch_number)
View(pitcher_df)
outcomes_df %>% pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, pitch_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutatate(events = events) %>%
head(100)
outcomes_df %>% pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, pitch_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(events = events) %>%
head(100)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, pitch_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(events = events) %>%
head(100)
View(outcomes_df)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, pitch_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(events = unqiue(events)[[2]]) %>%
head(100)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, pitch_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(events = unique(events)[[2]]) %>%
head(100)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, pitch_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(events = unique(events)[[1]]) %>%
head(100)
View(outcomes_df)
unique(outcomes_df$events[[1:6]])
unique(outcomes_df$events[1:6])
unique(outcomes_df$events[1:6])[[2]]
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, pitch_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
fill(events, .direction = "down") %>%
head(100)
View(outcomes_df)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, pitch_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
fill(events, .direction = "up") %>%
head(100)
View(outcomes_df)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, pitch_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(events = rev(coalesce(rev(events), events))) %>%
head(100)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, pitch_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(events = ifelse(events == "", NA, events),
events = last(events, na.rm = TRUE)) %>%
head(100)
last(c("", "events"))
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, pitch_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(events = last(events)) %>%
head(100)
View(outcomes_df)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(events = last(events))
as.numeric(any(head(outcomes_df$events, 100) %in%  # 1 is out, 0 is hit/walk
c("strikeout", "pickoff_1b", "pickoff_3b",
"strikeout_double_play", "triple_play",
"double_play", "caught_stealing_2b",
"field_out", "caught_stealing_home",
"grounded_into_double_play",
"other_out"
as.numeric(any(head(outcomes_df$events, 100) %in%  # 1 is out, 0 is hit/walk
c("strikeout", "pickoff_1b", "pickoff_3b",
"strikeout_double_play", "triple_play",
"double_play", "caught_stealing_2b",
"field_out", "caught_stealing_home",
"grounded_into_double_play",
"other_out")))
any(head(outcomes_df$events, 100) %in%  # 1 is out, 0 is hit/walk
c("strikeout", "pickoff_1b", "pickoff_3b",
"strikeout_double_play", "triple_play",
"double_play", "caught_stealing_2b",
"field_out", "caught_stealing_home",
"grounded_into_double_play",
"other_out"))
head(outcomes_df$events, 100) %in%  # 1 is out, 0 is hit/walk
c("strikeout", "pickoff_1b", "pickoff_3b",
"strikeout_double_play", "triple_play",
"double_play", "caught_stealing_2b",
"field_out", "caught_stealing_home",
"grounded_into_double_play",
"other_out")
as.numeric(head(outcomes_df$events, 100) %in%  # 1 is out, 0 is hit/walk
c("strikeout", "pickoff_1b", "pickoff_3b",
"strikeout_double_play", "triple_play",
"double_play", "caught_stealing_2b",
"field_out", "caught_stealing_home",
"grounded_into_double_play",
"other_out"))
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events) %>%
head(1000) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(events = last(events), outcome = as.numeric(
events %in% c("strikeout", "pickoff_1b", "pickoff_3b", "other_out",
"strikeout_double_play", "double_play", "triple_play",
"caught_stealing_2b", "field_out", "caught_stealing_home",
"grounded_into_double_play")))
View(outcomes_df)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(events = last(events), outcome = as.numeric(
events %in% c("strikeout", "pickoff_1b", "pickoff_3b", "other_out",
"strikeout_double_play", "double_play", "triple_play",
"caught_stealing_2b", "field_out", "caught_stealing_home",
"grounded_into_double_play")))
View(outcomes_df)
sum(outcomes_df$outcome) / nrow(outcomes_df)
1 - (sum(outcomes_df$outcome) / nrow(outcomes_df))
View(pitcher_df)
colnames(stats_df)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(outcome = as.numeric(
events %in% c("strikeout", "pickoff_1b", "pickoff_3b", "other_out",
"strikeout_double_play", "double_play", "triple_play",
"caught_stealing_2b", "field_out", "caught_stealing_home",
"grounded_into_double_play")))
View(outcomes_df)
head(stats_df$type, 10)
head(stats_df$type, 100)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(outcome = as.numeric(
events %in% c("strikeout", "pickoff_1b", "pickoff_3b", "other_out",
"strikeout_double_play", "double_play", "triple_play",
"caught_stealing_2b", "field_out", "caught_stealing_home",
"grounded_into_double_play")),
call = as.numeric(type == "S"), score = outcome + call)
pitcher_df <- stats_df %>%
select(pitch_type, game_pk, game_year, game_date, pitcher, release_speed,
release_spin_rate, pfx_x, pfx_z, at_bat_number, pitch_number,
events, type) %>%
mutate(pitcher_year = paste0(pitcher, "_", game_year)) %>%
filter(pitcher_year %in% pitcher_names$pitcher_year,
!is.na(release_speed), !is.na(release_spin_rate), !is.na(pfx_x),
!is.na(pfx_z), !(pitch_type %in% c("IN", "PO", ""))) %>%
arrange(pitcher, game_date, game_pk, at_bat_number, pitch_number)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events, type) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(outcome = as.numeric(
events %in% c("strikeout", "pickoff_1b", "pickoff_3b", "other_out",
"strikeout_double_play", "double_play", "triple_play",
"caught_stealing_2b", "field_out", "caught_stealing_home",
"grounded_into_double_play")),
call = as.numeric(type == "S"), score = outcome + call)
View(outcomes_df)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events, type) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(outcome = as.numeric(
events %in% c("strikeout", "pickoff_1b", "pickoff_3b", "other_out",
"strikeout_double_play", "double_play", "triple_play",
"caught_stealing_2b", "field_out", "caught_stealing_home",
"grounded_into_double_play")),
call = as.numeric(type == "S"), score = outcome + call,
out = as.numeric(score >= 1))
View(outcomes_df)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events, type) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(outcome = as.numeric(
events %in% c("strikeout", "pickoff_1b", "pickoff_3b", "other_out",
"strikeout_double_play", "double_play", "triple_play",
"caught_stealing_2b", "field_out", "caught_stealing_home",
"grounded_into_double_play")),
call = as.numeric(type == "S"), score = outcome + call,
good_outcome = as.numeric(score >= 1))
View(outcomes_df)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events, type) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(event = as.numeric(
events %in% c("strikeout", "pickoff_1b", "pickoff_3b", "other_out",
"strikeout_double_play", "double_play", "triple_play",
"caught_stealing_2b", "field_out", "caught_stealing_home",
"grounded_into_double_play")),
call = as.numeric(type == "S"), score = event + call,
outcome = as.numeric(score >= 1))
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events, type) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(event = as.numeric(
events %in% c("strikeout", "field_out", "grounded_into_double_play",
"double_play", "triple_play", "pickoff_1b", "pickoff_3b",
"caught_stealing_2b", "caught_stealing_home", "other_out",
"strikeout_double_play")), call = as.numeric(type == "S"),
score = event + call, outcome = as.numeric(score >= 1)) %>%
select(-event, -call, -outcome)
outcomes_df <- pitcher_df %>%
select(game_pk, game_year, pitcher, at_bat_number, events, type) %>%
group_by(pitcher, game_year, game_pk, at_bat_number) %>%
mutate(event = as.numeric(
events %in% c("strikeout", "field_out", "grounded_into_double_play",
"double_play", "triple_play", "pickoff_1b", "pickoff_3b",
"caught_stealing_2b", "caught_stealing_home", "other_out",
"strikeout_double_play")), call = as.numeric(type == "S"),
score = event + call, outcome = as.numeric(score >= 1)) %>%
select(-event, -call, -score)
View(outcomes_df)
View(head((cbind(test_df_1, test_df_2, outcomes_df$outcome) %>% `colnames<-`(c("cluster", "info", "outcome"))), 10000))
head((cbind(test_df_1, test_df_2, outcomes_df$outcome) %>% `colnames<-`(c("cluster", "info", "outcome"))), 10000) %>% View()
head((cbind(test_df_1, test_df_2, outcomes_df$outcome) %>%
`colnames<-`(c("cluster", "info", "outcome"))), 10000) %>%
View()
View(pitcher_df)
